<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø¯Ø§Ù…Ø§ Ù…ØºØ±Ø¨ÙŠØ© - Ø­Ø±ÙŠØ© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±</title>
    <style>
        :root { --board-dark: #7b4a35; --board-light: #f0d9b5; --player: #e74c3c; --bot: #2c3e50; }
        body { background: #1a1a1a; color: white; text-align: center; font-family: sans-serif; margin: 0; touch-action: manipulation; }
        .status { background: #333; padding: 15px; font-weight: bold; border-bottom: 2px solid #555; color: #2ecc71; }
        .board { display: grid; grid-template-columns: repeat(8, 1fr); width: 95vw; height: 95vw; max-width: 450px; max-height: 450px; margin: 20px auto; border: 10px solid #5d3a2a; }
        .cell { width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; }
        .dark { background: var(--board-dark); }
        .light { background: var(--board-light); }
        .piece { width: 80%; height: 80%; border-radius: 50%; border: 2px solid #fff; transition: 0.2s; position: relative; }
        .red { background: var(--player); }
        .black-piece { background: var(--bot); }
        .king::after { content: 'ðŸ‘‘'; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 1.2rem; }
        .selected { transform: scale(1.1); box-shadow: 0 0 15px yellow; }
        button { padding: 12px 25px; border-radius: 5px; background: #e67e22; color: white; border: none; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="status" id="status">Ø§Ù„Ø¹Ø¨ Ø¨Ø­Ø±ÙŠØ© - Ø§Ù„Ø£ÙƒÙ„ Ù„ÙŠØ³ Ø¥Ø¬Ø¨Ø§Ø±ÙŠØ§Ù‹</div>
    <div class="board" id="board"></div>
    <button onclick="location.reload()">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©</button>

    <script>
        const boardEl = document.getElementById('board');
        const statusEl = document.getElementById('status');
        let board = Array(64).fill(null);
        let turn = 'player';
        let selected = null;

        function init() {
            for (let i = 0; i < 64; i++) {
                let r = Math.floor(i/8), c = i%8;
                if ((r+c)%2 !== 0) {
                    if (r < 3) board[i] = { color: 'bot', king: false };
                    else if (r > 4) board[i] = { color: 'player', king: false };
                }
            }
            render();
        }

        function render() {
            boardEl.innerHTML = '';
            board.forEach((p, i) => {
                const cell = document.createElement('div');
                cell.className = `cell ${(Math.floor(i/8)+i%8)%2!==0 ? 'dark':'light'}`;
                if (p) {
                    const div = document.createElement('div');
                    div.className = `piece ${p.color==='player'?'red':'black-piece'} ${p.king?'king':''}`;
                    if (selected === i) div.classList.add('selected');
                    cell.appendChild(div);
                }
                cell.onclick = () => handleClick(i);
                boardEl.appendChild(cell);
            });
        }

        function handleClick(i) {
            if (turn !== 'player') return;
            if (board[i] && board[i].color === 'player') {
                selected = i;
            } else if (selected !== null) {
                let move = findValidMove(selected, i, 'player');
                if (move) {
                    executeMove(move);
                    turn = 'bot';
                    statusEl.innerText = "Ø¯ÙˆØ± Ø§Ù„Ø¨ÙˆØª...";
                    setTimeout(botMove, 700);
                }
            }
            render();
        }

        function findValidMove(from, to, color) {
            if (board[to]) return null;
            let r1 = Math.floor(from/8), c1 = from%8;
            let r2 = Math.floor(to/8), c2 = to%8;
            let dr = r2 - r1, dc = Math.abs(c2 - c1);

            // Ø­Ø±ÙƒØ© Ø¹Ø§Ø¯ÙŠØ© (Ù…Ø±Ø¨Ø¹ ÙˆØ§Ø­Ø¯)
            if (dc === 1) {
                if (board[from].king || (color === 'player' && dr === -1) || (color === 'bot' && dr === 1)) {
                    return { f: from, t: to };
                }
            }
            // Ù‚ÙØ²Ø© Ø£ÙƒÙ„ (Ù…Ø±Ø¨Ø¹ÙŠÙ†)
            if (dc === 2 && Math.abs(dr) === 2) {
                let mid = (from + to) / 2;
                if (board[mid] && board[mid].color !== color) {
                    return { f: from, t: to, m: mid };
                }
            }
            return null;
        }

        function executeMove(m) {
            board[m.t] = board[m.f];
            board[m.f] = null;
            if (m.m) board[m.m] = null;
            if (Math.floor(m.t/8) === 0 && board[m.t].color === 'player') board[m.t].king = true;
            if (Math.floor(m.t/8) === 7 && board[m.t].color === 'bot') board[m.t].king = true;
            selected = null;
        }

        function botMove() {
            let allMoves = [];
            board.forEach((p, i) => {
                if (p && p.color === 'bot') {
                    let targets = [i+7, i+9, i+14, i+18, i-7, i-9, i-14, i-18];
                    targets.forEach(t => {
                        if (t>=0 && t<64) {
                            let m = findValidMove(i, t, 'bot');
                            if (m) allMoves.push(m);
                        }
                    });
                }
            });
            
            if (allMoves.length) {
                // Ø§Ù„Ø¨ÙˆØª ÙŠÙØ¶Ù„ Ø§Ù„Ø£ÙƒÙ„ Ø¥Ø°Ø§ ÙˆØ¬Ø¯Ù‡ØŒ Ù„ÙƒÙ†Ù‡ ØºÙŠØ± Ù…Ø¬Ø¨Ø± Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹ Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¬Ø¯ Ù‡Ø¯ÙØ§Ù‹
                let jumps = allMoves.filter(m => m.m);
                let finalMove = jumps.length ? jumps[Math.floor(Math.random()*jumps.length)] : allMoves[Math.floor(Math.random()*allMoves.length)];
                executeMove(finalMove);
            }
            turn = 'player';
            statusEl.innerText = "Ø¯ÙˆØ±Ùƒ Ø§Ù„Ø¢Ù†";
            render();
        }

        init();
    </script>
</body>
</html>
